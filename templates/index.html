<!DOCTYPE html>
<html>
<head>
    <title>GOLD-PRO-AI Signal Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body {
            background: #0b1220;
            color: #eaeaea;
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        h1 { color: #f5c542; }
        button {
            padding: 12px 18px;
            background: #22c55e;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
        }
        .banner {
            margin: 15px 0;
            padding: 12px;
            border-radius: 6px;
            background: #7c2d12;
            color: #fde68a;
            display: none;
        }
        table {
            width: 100%;
            margin-top: 20px;
            border-collapse: collapse;
        }
        th, td {
            padding: 10px;
            border-bottom: 1px solid #333;
            text-align: center;
        }
        th { color: #38bdf8; }
    </style>
</head>
<body>
    <h1>ðŸš€ GOLD-PRO-AI Signal Dashboard</h1>
    <p>Status: <b>RUNNING</b></p>

    <div id="marketBanner" class="banner">
        â›” Market is currently closed (Weekend).  
        Signals will resume when markets open.
    </div>

    <button onclick="runScan()">Run Signal Scan</button>

    <table>
        <thead>
            <tr>
                <th>Symbol</th>
                <th>Signal</th>
                <th>Confidence</th>
                <th>Price</th>
                <th>Time</th>
            </tr>
        </thead>
        <tbody id="signals">
            <tr><td colspan="5">No signals yet</td></tr>
        </tbody>
    </table>

<script>
async function loadStatus() {
    const res = await fetch('/status');
    const data = await res.json();

    if (data.market_closed) {
        document.getElementById('marketBanner').style.display = 'block';
    }

    render(data.signals || []);
}

async function runScan() {
    const res = await fetch('/run');
    const data = await res.json();
    render(data.all_signals || []);
}

function render(signals) {
    const tbody = document.getElementById('signals');
    tbody.innerHTML = '';
    if (signals.length === 0) {
        tbody.innerHTML = '<tr><td colspan="5">No signals yet</td></tr>';
        return;
    }
    signals.slice().reverse().forEach(s => {
        tbody.innerHTML += `
            <tr>
                <td>${s.symbol}</td>
                <td>${s.signal}</td>
                <td>${s.confidence}%</td>
                <td>${s.price}</td>
                <td>${s.timestamp}</td>
            </tr>
        `;
    });
}

loadStatus();
</script>
</body>
</html>
